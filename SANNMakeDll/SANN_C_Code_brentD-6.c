//Analysis Type - Regression 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double brentD_6_MLP_20_24_1_input_hidden_weights[24][20]=
{
 {1.36988748645807e-002, -9.87033857576023e-003, 8.46006940283820e-003, -8.88560441932415e-003, 2.05124429060710e-003, 1.81878983248852e-002, 3.53882603501203e-002, 7.10961499695933e-003, 3.15759306991345e-002, 2.76441101536445e-002, 1.58175363150864e-002, 4.15696698008229e-002, 2.11045855383821e-002, -6.22455892647657e-004, 2.13203648242147e-002, 3.04487865879854e-002, 3.07588994252002e-002, 3.89454876328726e-002, 1.92484954926173e-002, 1.06155847867270e-001 },
 {-5.22580162356954e-002, 3.22327113791350e-004, 1.58090280277902e-002, -2.04958194799297e-002, 3.71065107639205e-002, 1.40799753195457e-002, -1.35900342914465e-002, 5.94727835672481e-003, -6.57311280890683e-003, -2.07362035205582e-002, -3.85637147271051e-002, 2.00187523992947e-003, -5.06361045337903e-002, 3.72870783738550e-002, -4.07782856289423e-002, 3.71267398096482e-002, -2.83595806823919e-002, -2.87199878380713e-005, -5.63308684063112e-002, 1.85451597370074e-001 },
 {-5.00866471745816e-002, -3.87401563238009e-002, -3.12169109624790e-002, -4.94839563743717e-002, 1.22012610138155e-002, -4.97469437230833e-002, -1.95938641640681e-002, -1.62825917920805e-002, -1.62209185973030e-002, -9.85455185596038e-002, 1.34365415714138e-002, 6.52084291980341e-004, 1.79639652561609e-002, -3.20127558066912e-002, -1.69018772482684e-003, -1.02401657148079e-001, -2.03916979084714e-002, -4.97300635056605e-002, -4.90236013488838e-003, -1.90201752958922e-001 },
 {-1.69579736102348e-002, 1.91367752541040e-002, 3.09513850520655e-002, -1.13996067273250e-002, 3.09298175263258e-002, 8.16655776562959e-003, 1.18249708991799e-002, 1.36161741928614e-002, 4.43327793561065e-002, 2.81791103977756e-002, 9.71086662022626e-003, 2.92628837969540e-002, 2.93368203093313e-002, 1.68470655895021e-002, 4.28353671324321e-002, 1.30500454072928e-002, -4.26387416004812e-003, 2.88051576478903e-002, 1.44305554921146e-002, 4.14827332018290e-003 },
 {4.04042085718553e-002, 6.32007902763806e-002, 3.89750208879196e-002, 3.62806836635648e-002, 1.29659650058102e-004, 3.14206479011497e-002, 4.15746447199522e-002, 6.22175541956553e-003, 1.74727682188289e-002, 3.93557523471568e-002, 3.94146280009873e-002, 1.42590299259635e-002, 2.00070003052818e-002, 3.71003735078796e-002, 6.57575657980651e-002, -1.46424499215884e-002, 8.18505556482225e-002, 5.74935093276909e-002, 8.50595644008389e-002, -4.47695727163675e-002 },
 {-4.58856033543042e-002, -1.97558859010729e-002, -5.03729361482723e-002, -9.85968543342812e-002, -1.15041064327855e-001, -1.01059015857531e-001, -8.71100081886664e-002, -6.89857912516017e-002, -6.25270353405654e-002, 2.29495959088621e-002, -7.34307469392310e-002, -7.12192435463733e-002, -1.60293483569838e-001, -4.22260282823069e-002, -1.44326908548991e-001, 7.11704738944392e-003, -1.10399249690898e-001, -4.25097804989618e-002, -1.17299092970445e-001, 1.82543070432732e-001 },
 {9.83309555911312e-003, -1.23489206910630e-001, -2.46672290336786e-002, 3.28067982388303e-002, -6.16210125711881e-003, -6.52104158167798e-002, 5.65604631579889e-003, 1.84960617205541e-002, -1.61853166445021e-002, -6.84024541115284e-002, -1.82671688853217e-002, -5.14947920566396e-003, 3.44465191803675e-002, -3.41771340065988e-002, 7.00181342431594e-002, -1.24263715691969e-001, -2.32894512855813e-002, -8.71019300225761e-002, -1.74759013972051e-003, -2.81734197712812e-001 },
 {-1.46070815012991e-002, -7.34598355039499e-003, 2.57909477334412e-002, 3.79931629634764e-002, -5.92720549834298e-002, -1.12565724100099e-002, 9.39620963192227e-003, 1.94659679751372e-002, 4.40151288035398e-002, -3.06377798093135e-002, -4.06933096864468e-002, 1.29088421747264e-001, 3.11849437344561e-002, 8.89831054402897e-003, -2.88523157565766e-002, 1.38297019945802e-001, -1.64061211064649e-001, 4.70691422171674e-002, -9.80962039254257e-002, 4.74703913164423e-001 },
 {-6.53127510730465e-003, -6.62743377547310e-003, -1.86703093212732e-002, -5.18002279568006e-004, -1.21051933670462e-002, 3.63981349037235e-002, -2.67930792171646e-004, 2.34116879469472e-002, 2.53918843619015e-003, -2.21613987707248e-002, 8.52545554956412e-003, 2.66058550206157e-002, 1.76232766635121e-002, -3.41828484553601e-003, -3.08414048048701e-002, 1.32368631512800e-002, -2.77177721477302e-002, 1.49012826757448e-002, -2.40211690262023e-002, 1.96758843863735e-001 },
 {-5.14368448628619e-002, -1.66363563498810e-002, 1.06327856651861e-003, -2.48663696355994e-002, 2.82656413056438e-002, -4.58715124323488e-002, -9.12288722361226e-003, 1.14064061230269e-002, -7.70372374298401e-002, -3.24375497514877e-002, 1.57981748852204e-002, -3.22315879411146e-002, 1.90304092442668e-002, -4.94652344523773e-002, 4.80007355211267e-003, -3.67650067828687e-002, -1.49042869076392e-002, 2.15662222966129e-002, 1.56454609111581e-004, -1.05651189976740e-001 },
 {-2.43632617483673e-003, -5.09260530122873e-002, -9.48088660641366e-003, -5.98939579116058e-002, -1.84779937724362e-002, -5.30790047851321e-003, -3.60822317112570e-002, -1.75867555852247e-002, -3.09080809225529e-002, -4.90926898624870e-002, -1.29523230906913e-002, -6.19204383555595e-002, 2.65661599061895e-002, -2.12853536955629e-002, 5.04950142894651e-002, -1.15204349563922e-001, 1.19042159175529e-002, -6.65057736913047e-002, -3.27200151562650e-003, -2.34055591046678e-001 },
 {-1.89594045622459e-002, 2.04392654205076e-002, 5.50901761253651e-002, 9.37916459630381e-002, 5.27224826397251e-002, 8.75627719723039e-002, 4.26753330493157e-002, 3.18279078422114e-003, 4.84529004753406e-002, 3.46336837133338e-002, 3.88728605649307e-002, 7.90572676475176e-002, 5.10621321562945e-002, 9.50699447495208e-003, 2.03046139077831e-002, 6.29435736660643e-002, -2.03876807051214e-002, 3.98944409723962e-002, 5.05090609128955e-003, 9.52239648900188e-002 },
 {4.34347839594788e-002, -2.35123578394839e-004, 1.42476123406522e-002, 1.86158606526677e-002, 5.33903680866461e-002, 7.25681860802481e-002, 3.42834539326472e-002, 4.69815501214157e-002, 1.35830311440131e-002, 2.42572146945027e-002, 8.13019786564585e-002, 1.43435889182446e-002, 1.09326631448851e-002, 2.98568049250388e-002, 9.79862020290282e-002, 5.02753360661596e-002, 9.03771156946066e-002, 3.99592589825776e-003, 5.45290649517362e-002, -2.08004663888192e-001 },
 {-5.69586372480958e-002, -5.24187526717774e-002, -8.57948963064420e-002, -5.07704657950249e-002, -3.99361425627482e-002, -5.42714486001492e-002, -4.23668204050795e-002, -2.32877053544322e-002, -5.75086577382548e-002, -7.73076926300793e-003, -1.14334818745092e-002, -6.43641104368315e-002, -5.03832932172174e-002, -7.65812301370321e-002, -4.90869388011989e-002, -8.91152336248047e-002, -4.80516321898591e-002, -1.04082919044564e-001, -5.30403636884074e-002, -1.50790087456823e-001 },
 {2.39868974703212e-002, 1.71836779143008e-002, 4.52807787962449e-003, 4.53291528370495e-003, 9.73156410335540e-003, 9.89302349554092e-003, 2.53273180508402e-002, 3.39704031162529e-002, 2.51970593562556e-002, 1.67054814412815e-003, 2.56608476548378e-002, -5.47960510976803e-003, 4.26474410449859e-002, 2.08177271126817e-002, 8.93177730021378e-003, 2.26131763680581e-002, 8.97819386985899e-003, 1.88139073528429e-002, -2.51264167513399e-002, 1.90685619080182e-002 },
 {6.32831994374299e-002, 1.21331299723762e-002, 1.27737233309416e-003, 1.42623453700802e-002, 4.70145612131389e-002, -1.29393792531475e-002, 3.88943874016133e-002, 3.68256303626532e-002, 4.24570428206893e-003, 4.88773739479703e-002, 2.99595515442806e-002, -1.39251491848419e-002, 5.32340410296273e-002, 2.88244739500817e-002, 1.90384767341858e-002, 2.01228522999223e-002, 6.64415870485571e-002, 3.17031996727901e-002, 5.41982231684833e-002, -5.30455928067499e-002 },
 {9.81709939542356e-003, -7.55759898591459e-002, -4.67861926260359e-002, 4.71116485485192e-003, -1.23561392707863e-002, -3.26493685161896e-002, -1.79645910385419e-002, -2.01779538630547e-003, -2.74487444445296e-002, -4.77773498370584e-002, -2.85962311925370e-002, -4.58240778286020e-002, -4.06758209476800e-002, -4.04958874193490e-002, 4.46274235726187e-002, -6.16105632894589e-002, 1.19015118855521e-002, -7.24600561419178e-002, 5.06202704637775e-002, -2.82273761841628e-001 },
 {1.78958773524705e-002, -7.73893980262875e-002, -2.95860928625281e-002, 1.19009836226444e-002, 4.98395858480854e-002, -2.37677641515624e-002, 3.22687190996429e-003, 3.30145638935907e-002, -5.65099536039766e-003, -3.25968911849137e-002, 2.53543154851849e-002, 1.36020235754344e-003, 1.08958794089982e-001, -6.32860395317123e-002, 5.12520949454914e-002, -1.48826367411806e-001, 5.82583426647484e-003, -7.22881072217000e-002, 4.07866398778054e-002, -3.48009493248011e-001 },
 {-4.61985470326779e-002, 4.37045881381859e-003, 3.79662198002945e-003, -7.64486878676571e-002, -6.94604045781496e-002, 1.28563928951431e-002, -4.81892583211335e-002, -3.76703020989624e-002, -4.34293565317175e-002, 1.36608997229728e-002, -6.52826377258152e-002, -2.81692651736462e-002, -4.60073666158902e-002, -3.11870071824125e-002, -8.68061639918930e-002, 3.15430492267722e-002, -4.77998113900587e-002, 1.78423006816076e-002, -5.24553548938767e-002, 1.17762103424657e-001 },
 {-4.82942140528713e-002, -3.45390121632024e-002, -3.19809813751957e-002, -2.22398989572228e-002, -7.72102302744457e-002, -2.95965065884839e-002, -1.41200779418855e-002, 1.03049972026445e-002, -4.54325707733278e-002, -3.11815933033809e-002, -7.49787768783674e-002, 4.66252651584136e-002, -4.81850258547761e-002, 2.08784677024183e-002, -8.76488061024036e-002, 1.39402705046465e-001, -7.88652697039849e-002, 7.36722429160714e-002, -8.51640991187624e-002, 4.97433873009755e-001 },
 {-3.08785660906841e-002, -7.86357359497696e-002, -4.07458231572883e-002, -6.55872470312893e-002, -3.93534279607356e-003, -5.56693149941489e-002, -7.37770855715716e-003, -1.53241362436942e-002, -3.37600451903331e-003, -7.10137606589929e-002, -2.25833591185395e-002, -4.96837927321920e-002, 2.46954002305079e-002, -4.19692841303940e-002, 3.08094462219240e-002, -1.18649662849945e-001, -3.29074957573655e-002, -4.39097580264537e-002, 5.00762406637400e-002, -2.48530645949076e-001 },
 {-1.38484961011886e-002, -3.69029656760758e-002, -5.27961221474619e-002, -1.81325329507941e-003, 5.55255852652482e-003, -4.03498318412571e-002, -3.90762434713778e-002, -1.42930035349047e-002, -1.72719089461069e-002, -2.63765910389725e-002, -3.31144958614218e-002, -3.85720794650991e-004, 7.11465248635741e-003, -1.74278841939300e-002, 2.27319412105884e-002, -5.44312278247795e-002, -7.09075228573709e-003, -5.19249831736931e-002, -1.57966132759664e-002, -1.58961598457057e-001 },
 {-1.28085655715039e-002, 1.53984686857233e-002, 1.63085960800451e-002, 4.13144824872774e-002, 3.30814224335373e-003, 1.20201528058224e-002, 9.26829459833675e-003, 5.57795006267039e-003, 4.76257498052833e-002, 1.30931352694613e-002, 1.72452448355761e-002, 7.44621994831970e-002, 2.90632051912534e-002, 4.18481251828791e-002, 1.16831213292843e-002, 4.18776651521489e-002, -3.81534427239684e-002, 5.07676645438584e-002, -4.48432434495990e-002, 2.44052434315243e-001 },
 {-2.09567476577023e-002, 6.29434374069105e-003, 5.71392459627849e-003, -8.27623155039888e-003, -2.46079913284461e-002, 1.93209291041463e-002, -1.22231826988864e-002, 8.06204704364426e-003, 2.46623002930015e-003, -1.71621918181789e-002, 1.16107627601609e-004, 6.45232440389320e-002, 8.03757371988741e-003, -7.83808770134630e-003, 6.98836452881687e-003, 9.44876292172563e-002, -3.26585505925531e-002, 7.12021567763623e-002, 1.19805796853009e-003, 2.03077755817868e-001 } 
};

double brentD_6_MLP_20_24_1_hidden_bias[24]={ -3.89969206097780e-002, -1.09524716751555e-001, 6.42491589044076e-002, -8.82219525802605e-002, -8.99232808708480e-002, -6.19211532263591e-002, -8.61926387646534e-002, 9.14872814859166e-002, -8.32141293492307e-002, 3.48826961346025e-002, 5.33442423498125e-002, -5.71137504017423e-002, -9.32976360240049e-002, 4.55332933430027e-002, -7.15780205957525e-002, -4.77019218406115e-002, -1.84217603429384e-002, 2.94226632205808e-002, -3.94741300347581e-002, -1.43016509266155e-001, 1.30229545936524e-002, 1.99965146218233e-002, 1.30479896886777e-002, -4.96920204892792e-003 };

double brentD_6_MLP_20_24_1_hidden_output_wts[1][24]=
{
 {-4.22415085919532e-003, 1.38197778747451e-001, -1.50631845711908e-001, -1.14915766288307e-002, -5.80380551420814e-002, 3.21987922704237e-001, -2.71100526675697e-001, 3.16174691562152e-001, 1.30751328559978e-001, -1.19388414709743e-001, -2.32077773119229e-001, 8.44738016179524e-002, -1.50896297652285e-002, 3.69890127624678e-002, -3.31823486405342e-002, -1.04340611853606e-001, -1.73744254948913e-001, -3.70222297943107e-001, 1.30212242984350e-001, 4.16003033731983e-001, -2.47715069785746e-001, -1.80440762759330e-001, 1.79861153102325e-001, 1.78053779462948e-001 }
};

double brentD_6_MLP_20_24_1_output_bias[1]={ 1.20206220105806e-001 };

double brentD_6_MLP_20_24_1_max_input[20]={ 1.44507000000000e+002, 1.47330000000000e+002, 1.43856000000000e+002, 1.45819000000000e+002, 1.45934000000000e+002, 1.47330000000000e+002, 1.43924000000000e+002, 1.44256000000000e+002, 1.44414000000000e+002, 1.47330000000000e+002, 1.42248000000000e+002, 1.44457000000000e+002, 1.44507000000000e+002, 1.47330000000000e+002, 1.43856000000000e+002, 1.45819000000000e+002, 1.45934000000000e+002, 1.46220000000000e+002, 1.43924000000000e+002, 1.44457000000000e+002 };

double brentD_6_MLP_20_24_1_min_input[20]={ 2.51840000000000e+001, 2.57650000000000e+001, 2.51140000000000e+001, 2.54210000000000e+001, 2.51840000000000e+001, 2.57650000000000e+001, 2.51140000000000e+001, 2.54210000000000e+001, 2.51840000000000e+001, 2.57650000000000e+001, 2.51140000000000e+001, 2.54210000000000e+001, 2.51840000000000e+001, 2.57650000000000e+001, 2.51140000000000e+001, 2.54210000000000e+001, 2.51840000000000e+001, 2.57650000000000e+001, 2.51140000000000e+001, 2.54210000000000e+001 };

double brentD_6_MLP_20_24_1_max_target[1]={ 1.46306000000000e+002 };

double brentD_6_MLP_20_24_1_min_target[1]={ 2.57650000000000e+001 };

double brentD_6_MLP_20_24_1_input[20];
double brentD_6_MLP_20_24_1_hidden[24];
double brentD_6_MLP_20_24_1_output[1];

double brentD_6_MLP_20_24_1_MeanInputs[20]={ 7.62565632517627e+001, 7.72402886768974e+001, 7.52246636250517e+001, 7.62570593114889e+001, 7.62558627125674e+001, 7.72481634176690e+001, 7.52174890087101e+001, 7.62628598092076e+001, 7.62678693488179e+001, 7.72508278722523e+001, 7.52307042720863e+001, 7.62636972210701e+001, 7.62660829531314e+001, 7.72556744089590e+001, 7.52305719618415e+001, 7.62736213189547e+001, 7.62771094981336e+001, 7.72554313562837e+001, 7.52489921194524e+001, 7.62723313977602e+001 };

void brentD_6_MLP_20_24_1_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(brentD_6_MLP_20_24_1_max_input[i]-brentD_6_MLP_20_24_1_min_input[i]);
	input[i] = minimum - delta*brentD_6_MLP_20_24_1_min_input[i]+ delta*input[i];
 }
}

void brentD_6_MLP_20_24_1_UnscaleTargets(double* output, double minimum, double maximum, int size)
{
  double delta;
  long i;
  for(i=0; i<size; i++)
  {
    delta = (maximum-minimum)/(brentD_6_MLP_20_24_1_max_target[i]-brentD_6_MLP_20_24_1_min_target[i]);
    output[i] = (output[i] - minimum + delta*brentD_6_MLP_20_24_1_min_target[i])/delta;
   }
}

void brentD_6_MLP_20_24_1_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
   }
}

void brentD_6_MLP_20_24_1_RunNeuralNet_Regression () 
{
  brentD_6_MLP_20_24_1_ComputeFeedForwardSignals((double*)brentD_6_MLP_20_24_1_input_hidden_weights,brentD_6_MLP_20_24_1_input,brentD_6_MLP_20_24_1_hidden,brentD_6_MLP_20_24_1_hidden_bias,20, 24,0);
  brentD_6_MLP_20_24_1_ComputeFeedForwardSignals((double*)brentD_6_MLP_20_24_1_hidden_output_wts,brentD_6_MLP_20_24_1_hidden,brentD_6_MLP_20_24_1_output,brentD_6_MLP_20_24_1_output_bias,24, 1,1);
}

int main()
{
  int cont_inps;
  int i=0;
  int keyin=1;
  while(1)
  {
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(O5): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[0]);
	printf("%s","Cont. Input-1(H5): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[1]);
	printf("%s","Cont. Input-2(L5): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[2]);
	printf("%s","Cont. Input-3(C5): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[3]);
	printf("%s","Cont. Input-4(O4): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[4]);
	printf("%s","Cont. Input-5(H4): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[5]);
	printf("%s","Cont. Input-6(L4): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[6]);
	printf("%s","Cont. Input-7(C4): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[7]);
	printf("%s","Cont. Input-8(O3): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[8]);
	printf("%s","Cont. Input-9(H3): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[9]);
	printf("%s","Cont. Input-10(L3): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[10]);
	printf("%s","Cont. Input-11(C3): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[11]);
	printf("%s","Cont. Input-12(O2): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[12]);
	printf("%s","Cont. Input-13(H2): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[13]);
	printf("%s","Cont. Input-14(L2): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[14]);
	printf("%s","Cont. Input-15(C2): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[15]);
	printf("%s","Cont. Input-16(O1): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[16]);
	printf("%s","Cont. Input-17(H1): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[17]);
	printf("%s","Cont. Input-18(L1): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[18]);
	printf("%s","Cont. Input-19(C1): ");
	scanf("%lg",&brentD_6_MLP_20_24_1_input[19]);
	for(cont_inps=0;cont_inps<20;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(brentD_6_MLP_20_24_1_input[cont_inps] == -9999)
	  brentD_6_MLP_20_24_1_input[cont_inps]=brentD_6_MLP_20_24_1_MeanInputs[cont_inps];
	}
    brentD_6_MLP_20_24_1_ScaleInputs(brentD_6_MLP_20_24_1_input,0,1,20);
	brentD_6_MLP_20_24_1_RunNeuralNet_Regression();
	brentD_6_MLP_20_24_1_UnscaleTargets(brentD_6_MLP_20_24_1_output,0,1,1);
	printf("\n%s%.14e","Predicted Output of H0 = ",brentD_6_MLP_20_24_1_output[0]);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

